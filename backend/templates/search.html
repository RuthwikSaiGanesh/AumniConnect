<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Search - AlumniConnect</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen font-sans">
  <header class="bg-blue-600 text-white shadow p-4 sticky top-0 z-10">
    <div class="container mx-auto flex justify-between items-center">
      <h1 class="text-2xl font-bold">AlumniConnect</h1>
      <button onclick="window.location.href='{{ url_for('main_routes.home') }}'" class="bg-white text-blue-600 px-4 py-2 rounded hover:bg-gray-200 transition">Home</button>
    </div>
  </header>

  <main class="container mx-auto p-4 max-w-xl">
    <div class="mb-4">
      <input id="search-input" type="text" placeholder="Search users..." class="w-full p-3 rounded border border-gray-300 focus:outline-blue-500" />
    </div>
    <ul id="results" class="space-y-2"></ul>
  </main>

  <script>
    const searchInput = document.getElementById('search-input');
    const resultsList = document.getElementById('results');

    let timeout = null;

    searchInput.addEventListener('input', function() {
      clearTimeout(timeout);
      const query = searchInput.value.trim();
      if (query.length === 0) {
        resultsList.innerHTML = '';
        return;
      }
      timeout = setTimeout(function() {
        fetch('/api/search_users?q=' + encodeURIComponent(query))
          .then(function(response) { return response.json(); })
          .then(function(data) {
            resultsList.innerHTML = '';
            if (data.length === 0) {
              resultsList.innerHTML = '<li class="text-gray-500">No users found.</li>';
              return;
            }
            data.forEach(function(user) {
              const li = document.createElement('li');
              li.className = 'flex items-center space-x-4 p-2 bg-white rounded shadow cursor-pointer hover:bg-gray-100';
              li.onclick = function() {
                window.location.href = '/profile_' + user.role + '?email=' + encodeURIComponent(user.email);
              };
              const img = document.createElement('img');
              img.src = user.profile_pic || 'https://via.placeholder.com/40';
              img.alt = user.name;
              img.className = 'w-10 h-10 rounded-full object-cover';
              const span = document.createElement('span');
              span.textContent = user.name;
              span.className = 'text-gray-800 font-medium';
              li.appendChild(img);
              li.appendChild(span);
              resultsList.appendChild(li);
            });
          });
      }, 300);
    });
  </script>
</body>
</html>
